@import 'tailwindcss';

@custom-variant light {
	@media (prefers-color-scheme: light) {
		&:not(.dark *) {
			@slot;
		}
	}
	&:is(.light *) {
		@slot;
	}
}

@custom-variant dark {
	@media (prefers-color-scheme: dark) {
		&:not(.light *) {
			@slot;
		}
	}
	&:is(.dark *) {
		@slot;
	}
}

@theme {
	--color-body-50: oklch(var(--body-lightness-50) var(--neutral-chroma) var(--hue-color));
	--color-body-100: oklch(var(--body-lightness-100) var(--neutral-chroma) var(--hue-color));
	--color-body-200: oklch(var(--body-lightness-200) var(--neutral-chroma) var(--hue-color));
	--color-body-300: oklch(var(--body-lightness-300) var(--neutral-chroma) var(--hue-color));
	--color-body-400: oklch(var(--body-lightness-400) var(--neutral-chroma) var(--hue-color));
	--color-body-500: oklch(var(--body-lightness-500) var(--neutral-chroma) var(--hue-color));

	--color-primary-50: oklch(var(--primary-lightness-50)  var(--primary-chroma-50)  var(--hue-color));
	--color-primary-100: oklch(var(--primary-lightness-100) var(--primary-chroma-100) var(--hue-color));
	--color-primary-200: oklch(var(--primary-lightness-200) var(--primary-chroma-200) var(--hue-color));
	--color-primary-300: oklch(var(--primary-lightness-300) var(--primary-chroma-300) var(--hue-color));
	--color-primary-400: oklch(var(--primary-lightness-400) var(--primary-chroma-400) var(--hue-color));
	--color-primary-500: oklch(var(--primary-lightness-500) var(--primary-chroma-500) var(--hue-color));
	--color-primary-600: oklch(var(--primary-lightness-600) var(--primary-chroma-600) var(--hue-color));
	--color-primary-700: oklch(var(--primary-lightness-700) var(--primary-chroma-700) var(--hue-color));
	--color-primary-800: oklch(var(--primary-lightness-800) var(--primary-chroma-800) var(--hue-color));
	--color-primary-900: oklch(var(--primary-lightness-900) var(--primary-chroma-900) var(--hue-color));
	--color-primary-950: oklch(var(--primary-lightness-950) var(--primary-chroma-950) var(--hue-color));

	--color-text-100: oklch(var(--text-lightness-100) var(--neutral-chroma) var(--hue-color));
	--color-text-200: oklch(var(--text-lightness-200) var(--neutral-chroma) var(--hue-color));
	--color-text-300: oklch(var(--text-lightness-300) var(--neutral-chroma) var(--hue-color));
	--color-text-400: oklch(var(--text-lightness-400) var(--neutral-chroma) var(--hue-color));
	--color-text-500: oklch(var(--text-lightness-500) var(--neutral-chroma) var(--hue-color));
	--color-text-600: oklch(var(--text-lightness-600) var(--neutral-chroma) var(--hue-color));
	--color-text-700: oklch(var(--text-lightness-700) var(--neutral-chroma) var(--hue-color));
	--color-text-800: oklch(var(--text-lightness-800) var(--neutral-chroma) var(--hue-color));
	--color-text-900: oklch(var(--text-lightness-900) var(--neutral-chroma) var(--hue-color));

	/*==================================================
		Font
		startValue + (endValue - startValue) * (((index - 1) / (totalNumber - 1)) ^ 1.5)
	==================================================*/
	--text-custom-md:  calc(1rem + (3rem - 1rem) * pow((0 / 6), 1.5)); /* 1.0000000000rem */
	--text-custom-lg:  calc(1rem + (3rem - 1rem) * pow((1 / 6), 1.5)); /* 1.1360827635rem */
	--text-custom-xl:  calc(1rem + (3rem - 1rem) * pow((2 / 6), 1.5)); /* 1.3849001795rem */
	--text-custom-2xl: calc(1rem + (3rem - 1rem) * pow((3 / 6), 1.5)); /* 1.7071067812rem */
	--text-custom-3xl: calc(1rem + (3rem - 1rem) * pow((4 / 6), 1.5)); /* 2.0886621079rem */
	--text-custom-4xl: calc(1rem + (3rem - 1rem) * pow((5 / 6), 1.5)); /* 2.5214515486rem */
	--text-custom-5xl: calc(1rem + (3rem - 1rem) * pow((6 / 6), 1.5)); /* 3.0000000000rem */
}

@layer base {
	:root {
		color-scheme: light;
		interpolate-size: allow-keywords;

		/*==================================================
			Global styling variables
		==================================================*/
		--serif: var(--font-instrument-serif), ui-serif, serif;
		--sans-serif: var(--font-inter), ui-sans-serif, sans-serif;
		--mono: var(--font-jetbrains-mono), ui-monospace, monospace;

		--isDarkMode:     0.00;
		--lightness-max:  0.97;
		--lightness-min:  0.20;
		--lightness-diff: calc(var(--lightness-max) - var(--lightness-min));
		--neutral-chroma: 0.01;
		--hue-color:      277;

		/*==================================================
			Body variables
		==================================================*/
		--body-step: calc(0.05 * (-1 + 2 * var(--isDarkMode)));
		--body-base: calc(var(--lightness-diff) * (1 - var(--isDarkMode)) + var(--lightness-min));

		--body-lightness-50: calc(var(--body-base) + (var(--body-step) * 0));
		--body-lightness-100: calc(var(--body-base) + (var(--body-step) * 1));
		--body-lightness-200: calc(var(--body-base) + (var(--body-step) * 2));
		--body-lightness-300: calc(var(--body-base) + (var(--body-step) * 3));
		--body-lightness-400: calc(var(--body-base) + (var(--body-step) * 4));
		--body-lightness-500: calc(var(--body-base) + (var(--body-step) * 5));

		/*==================================================
			Primary variables
			- calculate lightness: (lightestLightness - darkestLightness) * (i / (totalAmountOfColors - 1)) + darkestLightness
			- calculate chroma: (primaryChroma / primaryLightness) * (primaryLightness - abs(currentLightness - primaryLightness))
		==================================================*/
		--primary-lightness-50:  calc(var(--lightness-diff) * (10 / 10) + var(--lightness-min));
		--primary-lightness-100: calc(var(--lightness-diff) * (09 / 10) + var(--lightness-min));
		--primary-lightness-200: calc(var(--lightness-diff) * (08 / 10) + var(--lightness-min));
		--primary-lightness-300: calc(var(--lightness-diff) * (07 / 10) + var(--lightness-min));
		--primary-lightness-400: calc(var(--lightness-diff) * (06 / 10) + var(--lightness-min));
		--primary-lightness-500: calc(var(--lightness-diff) * (05 / 10) + var(--lightness-min));
		--primary-lightness-600: calc(var(--lightness-diff) * (04 / 10) + var(--lightness-min));
		--primary-lightness-700: calc(var(--lightness-diff) * (03 / 10) + var(--lightness-min));
		--primary-lightness-800: calc(var(--lightness-diff) * (02 / 10) + var(--lightness-min));
		--primary-lightness-900: calc(var(--lightness-diff) * (01 / 10) + var(--lightness-min));
		--primary-lightness-950: calc(var(--lightness-diff) * (00 / 10) + var(--lightness-min));

		--primary-chroma-factor: calc(0.2 / var(--primary-lightness-500));
		--primary-chroma-50:  calc(var(--primary-chroma-factor) * (var(--primary-lightness-500) - abs(var(--primary-lightness-50)  - var(--primary-lightness-500))));
		--primary-chroma-100: calc(var(--primary-chroma-factor) * (var(--primary-lightness-500) - abs(var(--primary-lightness-100) - var(--primary-lightness-500))));
		--primary-chroma-200: calc(var(--primary-chroma-factor) * (var(--primary-lightness-500) - abs(var(--primary-lightness-200) - var(--primary-lightness-500))));
		--primary-chroma-300: calc(var(--primary-chroma-factor) * (var(--primary-lightness-500) - abs(var(--primary-lightness-300) - var(--primary-lightness-500))));
		--primary-chroma-400: calc(var(--primary-chroma-factor) * (var(--primary-lightness-500) - abs(var(--primary-lightness-400) - var(--primary-lightness-500))));
		--primary-chroma-500: calc(var(--primary-chroma-factor) * (var(--primary-lightness-500) - abs(var(--primary-lightness-500) - var(--primary-lightness-500))));
		--primary-chroma-600: calc(var(--primary-chroma-factor) * (var(--primary-lightness-500) - abs(var(--primary-lightness-600) - var(--primary-lightness-500))));
		--primary-chroma-700: calc(var(--primary-chroma-factor) * (var(--primary-lightness-500) - abs(var(--primary-lightness-700) - var(--primary-lightness-500))));
		--primary-chroma-800: calc(var(--primary-chroma-factor) * (var(--primary-lightness-500) - abs(var(--primary-lightness-800) - var(--primary-lightness-500))));
		--primary-chroma-900: calc(var(--primary-chroma-factor) * (var(--primary-lightness-500) - abs(var(--primary-lightness-900) - var(--primary-lightness-500))));
		--primary-chroma-950: calc(var(--primary-chroma-factor) * (var(--primary-lightness-500) - abs(var(--primary-lightness-950) - var(--primary-lightness-500))));

		/*==================================================
			Text variables
		==================================================*/
		--text-lightness-max: calc(var(--lightness-max) + var(--lightness-min));

		--text-lightness-100: abs(var(--lightness-diff) * (8 / 8) + var(--lightness-min) - var(--text-lightness-max) * var(--isDarkMode));
		--text-lightness-200: abs(var(--lightness-diff) * (7 / 8) + var(--lightness-min) - var(--text-lightness-max) * var(--isDarkMode));
		--text-lightness-300: abs(var(--lightness-diff) * (6 / 8) + var(--lightness-min) - var(--text-lightness-max) * var(--isDarkMode));
		--text-lightness-400: abs(var(--lightness-diff) * (5 / 8) + var(--lightness-min) - var(--text-lightness-max) * var(--isDarkMode));
		--text-lightness-500: abs(var(--lightness-diff) * (4 / 8) + var(--lightness-min) - var(--text-lightness-max) * var(--isDarkMode));
		--text-lightness-600: abs(var(--lightness-diff) * (3 / 8) + var(--lightness-min) - var(--text-lightness-max) * var(--isDarkMode));
		--text-lightness-700: abs(var(--lightness-diff) * (2 / 8) + var(--lightness-min) - var(--text-lightness-max) * var(--isDarkMode));
		--text-lightness-800: abs(var(--lightness-diff) * (1 / 8) + var(--lightness-min) - var(--text-lightness-max) * var(--isDarkMode));
		--text-lightness-900: abs(var(--lightness-diff) * (0 / 8) + var(--lightness-min) - var(--text-lightness-max) * var(--isDarkMode));
	}

	/*==================================================
		Dark mode switch
	==================================================*/
	@media (prefers-color-scheme: dark) {
		html:not(.light) {
			--isDarkMode: 1;
			color-scheme: dark;
		}
	}
	html.dark {
		--isDarkMode: 1;
		color-scheme: dark;
	}

	/* ========== Global resets & defaults ========== */
	*,
	::before,
	::after {
		border-color: var(--color-body-200);
		transition-property: none;
		transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
		transition-duration: 150ms;
	}

	*:focus-visible {
		outline: solid 2px var(--color-primary-500);
		outline-offset: 2px;
	}

	::selection {
		color: var(--color-primary-50);
		background: var(--color-primary-500);
	}

	html {
		/*==================================================
			Header
				- height: 1.5rem
				- padding-block-start: height * 0.75
				- padding-block-end:   height * 0.75
				- margin-block-start:  (height + padding-block-start + padding-block-end) / 2 (translate-y-1/2)
			1.5rem + 1.125rem + 1.125rem + 1.875rem = 5.625rem
			added margin below the header so it matches top: 5.625rem + 1.875rem = 7.5rem
		==================================================*/
		scroll-padding-top: 7.5rem;
		hanging-punctuation: first last;
	}

	@media (prefers-reduced-motion: no-preference) {
		html {
			scroll-behavior: smooth;
		}
	}

	/*==================================================
		Typography
	==================================================*/
	body,
	dialog > * {
		font-family: var(--sans-serif);
		color: var(--color-text-700);
		font-size: var(--text-custom-md);
		font-weight: 400;
		font-variant-ligatures: none;
		line-height: 1.33;
	}

	h1,
	h2,
	h3,
	h4,
	h5,
	h6 {
		font-family: var(--serif);
		color: var(--color-text-800);
		line-height: 1;
		text-wrap: balance;
	}

	h1 {
		color: var(--color-text-900);
		font-size: var(--text-custom-5xl);
	}

	h2 {
		font-size: var(--text-custom-4xl);
	}

	h3 {
		font-size: var(--text-custom-3xl);
	}

	h4 {
		font-size: var(--text-custom-2xl);
	}

	h5 {
		font-size: var(--text-custom-xl);
	}

	h6 {
		font-size: var(--text-custom-lg);
	}

	p {
		max-width: 65ch;
		text-wrap: pretty;
	}

	*[class*="--mono"] {
		font-variant-ligatures: normal;
	}

	code,
	kbd,
	pre,
	samp {
		font-family: var(--mono);
	}

	.align-center {
		vertical-align: middle;
		margin-block-start: calc(1ex - 1cap);
	}

	/*==================================================
		Hamburger icon
	==================================================*/
	.hamburger-button .path1,
	.hamburger-button .path3 {
		stroke-dasharray: 60 207;
	}
	.hamburger-button .path2 {
		stroke-dasharray: 60 60;
	}
	.hamburger-button:has(~ #mobile-nav:popover-open) .path1,
	.hamburger-button:has(~ #mobile-nav:popover-open) .path3 {
		stroke-dasharray: 90 207;
		stroke-dashoffset: -134;
	}
	.hamburger-button:has(~ #mobile-nav:popover-open) .path2 {
		stroke-dasharray: 1 60;
		stroke-dashoffset: -30;
	}

	/*==================================================
		Full-Bleed Layout
	==================================================*/
	.breakout-wrapper {
		--gap: 2rem;
		--full: minmax(var(--gap), 1fr);
		--breakout: minmax(0, var(--gap));
		--content: min(100% - var(--gap) * 2, 80rem); /* 80rem = 1280px */

		display: grid;
		grid-template-columns:
			[full-start] var(--full)
			[\2xl-start] var(--breakout)
			[xl-start] var(--breakout)
			[lg-start] var(--breakout)
			[md-start] var(--breakout)
			[sm-start] var(--breakout)
			[content-start] var(--content) [content-end]
			var(--breakout) [sm-end]
			var(--breakout) [md-end]
			var(--breakout) [lg-end]
			var(--breakout) [xl-end]
			var(--breakout) [\2xl-end]
			var(--full) [full-end];

		& > * {
			grid-column: content;
		}

		& > .col-sm {
			grid-column: sm;
		}

		& > .col-md {
			grid-column: md;
		}

		& > .col-lg {
			grid-column: lg;
		}

		& > .col-xl {
			grid-column: xl;
		}

		& > .col-2xl {
			grid-column: \2xl;
		}

		& > .col-full {
			grid-column: full;
		}
	}

	/*==================================================
		Animated details
	==================================================*/
	details {
		overflow: hidden;
	}

	/*! don't add margin or padding here !*/
	details::details-content {
		block-size: 0;
		transition-property: block-size, content-visibility;
		transition-duration: 0.3s;
		transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
		transition-behavior: allow-discrete;
	}

	/*! don't add margin or padding here !*/
	details:open::details-content {
		block-size: auto;
	}


	/*==================================================
		Code blocks
	==================================================*/
	.shiki {
		overflow-x: scroll;
		overflow-y: clip;

		counter-reset: step;
		counter-increment: step 0;

		border-radius: 0.5rem;
		padding: 1rem;
	}

	.shiki .line::before {
		content: counter(step);
		counter-increment: step;
		width: 2ch;
		margin-right: 1.5rem;
		display: inline-block;
		text-align: right;
		color: rgba(115, 138, 148, 0.4);
	}

	.dark .shiki,
	.dark .shiki span {
		color: var(--shiki-dark) !important;
		background-color: var(--shiki-dark-bg) !important;
		font-style: var(--shiki-dark-font-style) !important;
		font-weight: var(--shiki-dark-font-weight) !important;
		text-decoration: var(--shiki-dark-text-decoration) !important;
	}
}